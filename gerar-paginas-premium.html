<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gerar p√°ginas premium | Planeta Dorama</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background:#0b0515;
      color:#f5f5f5;
    }
    header{
      background:radial-gradient(circle at top,#ff7eb3,#b983ff,#12001f);
      padding:20px;
      text-align:center;
      color:#fff;
      box-shadow:0 6px 18px rgba(0,0,0,0.4);
    }
    header h1{margin:0 0 8px;font-size:22px}
    header p{margin:0;font-size:14px;opacity:.9}
    main{
      max-width:900px;
      margin:28px auto;
      background:#140820;
      border-radius:18px;
      padding:18px 20px 22px;
      box-shadow:0 8px 24px rgba(0,0,0,0.5);
    }
    h2{margin:0 0 10px;font-size:18px;color:#ffb3e1}
    ol{margin:0 0 14px;padding-left:20px;font-size:14px;color:#ddd}
    li{margin-bottom:6px}
    code{
      background:#251034;
      padding:2px 5px;
      border-radius:4px;
      font-size:12px;
      color:#ffd6ff;
    }
    button{
      padding:12px 20px;
      border:none;
      border-radius:999px;
      background:#ff7eb3;
      color:#2b002d;
      font-weight:bold;
      cursor:pointer;
      font-size:15px;
      margin-top:8px;
    }
    button:hover{background:#ffd6ff}
    .log{
      margin-top:16px;
      background:#0b0515;
      border-radius:12px;
      padding:10px;
      font-size:13px;
      max-height:260px;
      overflow:auto;
      white-space:pre-wrap;
      border:1px solid #321444;
    }
  </style>

  <!-- libs para gerar ZIP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <!-- seus dados -->
  <script src="doramas.js"></script>
<script>
  // T√≠tulos em PT + EN para exibi√ß√£o amig√°vel
  const TITULOS_PT = {
    "Crash Landing on You": "Pousando no Amor (Crash Landing on You)",
    "Pousando no Amor": "Pousando no Amor (Crash Landing on You)",
    "Its Okay to Not Be Okay": "Tudo Bem N√£o Ser Normal (Its Okay to Not Be Okay)",
    "Tudo Bem N√£o Ser Normal": "Tudo Bem N√£o Ser Normal (Its Okay to Not Be Okay)",
    "Business Proposal": "Pretendente Surpresa (Business Proposal)",
    "A Business Proposal": "Pretendente Surpresa (Business Proposal)",
    "Pretendente Surpresa": "Pretendente Surpresa (Business Proposal)",
    "Extraordinary Attorney Woo": "Advogada Extraordin√°ria (Extraordinary Attorney Woo)",
    "Advogada Extraordin√°ria": "Advogada Extraordin√°ria (Extraordinary Attorney Woo)",
    "Sorriso Real": "Sorriso Real (King the Land)",
    "Vinte e Cinco, Vinte e Um": "Vinte e Cinco, Vinte e Um (Twenty-Five Twenty-One)",
    "Queen of Tears": "Rainha das L√°grimas (Queen of Tears)"
  };

  function nomeExibicao(d){
    const nome = d && d.nome ? String(d.nome) : "";
    return TITULOS_PT[nome] || nome;
  }

</script>
</head>
<body>

<header>
  <h1>Gerador de p√°ginas premium üåç</h1>
  <p>Planeta Dorama ‚Äì gera <code>/doramas/slug.html</code> para TODOS os doramas, no mesmo estilo.</p>
</header>

<main>
  <h2>Como usar</h2>
  <ol>
    <li>Atualize o <code>doramas.js</code> com todos os doramas novos.</li>
    <li>Acesse esta p√°gina pelo GitHub Pages:<br>
      <code>https://planetadorama.com.br/gerar-paginas-premium.html</code>
    </li>
    <li>Clique no bot√£o abaixo para gerar um arquivo <b>.zip</b> com todas as p√°ginas premium.</li>
    <li>Extraia o ZIP no seu computador.</li>
    <li>No GitHub, v√° na pasta <code>doramas</code> e envie todos os <code>.html</code> gerados (pode sobrescrever).</li>
  </ol>

  <button onclick="gerarPaginasPremium()">üöÄ Gerar ZIP com p√°ginas premium</button>

  <div id="log" class="log"></div>
</main>

<script>
  function log(msg){
    const box = document.getElementById("log");
    box.textContent += msg + "\n";
    box.scrollTop = box.scrollHeight;
  }

  function criarSlug(nome, nomeEN){
    const base = nomeEN || nome;
    return String(base || "")
      .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
      .toLowerCase()
      .replace(/[^a-z0-9]+/g, "-")
      .replace(/(^-|-$)/g, "");
  }

  function primeiraFrase(d){
    const txt = (d.descricao || d.resumo || "").trim();
    if(!txt) return "";
    return txt.split("\n")[0];
  }

  function corpoTexto(d){
    const txt = (d.resumo || d.descricao || "").trim();
    if(!txt) return "";
    return txt.replace(/\n/g,"<br>");
  }

  function gerarRecomendados(dorama, todos){
    const tags = Array.isArray(dorama.tags) ? dorama.tags : [];
    let candidatos = todos.filter(x => x !== dorama);

    if(tags.length){
      candidatos = candidatos.filter(x =>
        Array.isArray(x.tags) && x.tags.some(t => tags.includes(t))
      );
    }

    if(!candidatos.length){
      candidatos = todos.filter(x => x !== dorama);
    }

    candidatos = [...candidatos].sort(() => Math.random() - 0.5).slice(0,4);

    if(!candidatos.length) return "";

    const itens = candidatos.map(c => {
      const slug = c.slug || criarSlug(c.nome, c.nomeEN);
      const url = "/doramas/" + slug + ".html";
      return `
        <a class="rec-card" href="${url}">
          <img src="${c.imagem}" alt="${c.nome}" loading="lazy">
          <div class="rec-title">${c.nome}</div>
        </a>`;
    }).join("");

    return `
    <section class="bloco">
      <h2>Recomendados para voc√™</h2>
      <div class="rec-grid">
        ${itens}
      </div>
    </section>`;
  }

  function montarHtmlPremium(d, todos){
    const slug = d.slug || criarSlug(d.nome, d.nomeEN);
    const urlPagina = "https://planetadorama.com.br/doramas/" + slug + ".html";
    const nomeExibicao = window.nomeExibicao ? window.nomeExibicao(d) : (d.nome || "");

    const tituloPagina = nomeExibicao + " ‚Äì Elenco, Sinopse e Trailer | Planeta Dorama";
    const descCurta = primeiraFrase(d) || ("Saiba tudo sobre o dorama " + nomeExibicao + ".");
    const descAttr = descCurta.replace(/"/g,"&quot;");
    const corpo = corpoTexto(d);
    const nota = d.nota || "";
    const imagem = d.imagem || "https://planetadorama.com.br/imagens/og-capa.jpg";
    const tags = Array.isArray(d.tags) ? d.tags.join(", ") : "";
    const trailer = d.trailer || "";
    const recomendadosHtml = gerarRecomendados(d, todos);

    const trailerBloco = trailer ? `
    <section class="bloco">
      <h2>üé¨ Trailer</h2>
      <div class="video-wrap">
        <iframe src="${trailer}" loading="lazy" allowfullscreen></iframe>
      </div>
    </section>` : "";

    const tagsHtml = tags
      ? tags.split(",").map(t => `<span class="tag">${t.trim()}</span>`).join("")
      : "";

    return `<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>${tituloPagina}</title>
  <meta name="description" content="${descAttr}">
  <link rel="canonical" href="${urlPagina}">
  <meta name="robots" content="index,follow">

  <meta property="og:title" content="${nomeExibicao} | Planeta Dorama">
  <meta property="og:description" content="${descCurta}">
  <meta property="og:url" content="${urlPagina}">
  <meta property="og:type" content="website">
  <meta property="og:image" content="${imagem}">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="${nomeExibicao} | Planeta Dorama">
  <meta name="twitter:description" content="${descCurta}">
  <meta name="twitter:image" content="${imagem}">

  <style>
    :root{
      --bg:#05020b;
      --card:#12071f;
      --accent:#ff7eb3;
      --accent2:#b983ff;
      --text:#f8f6ff;
      --sub:#c0b2ff;
      --shadow:0 18px 45px rgba(0,0,0,0.75);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Arial,system-ui,sans-serif;
      background:radial-gradient(circle at top,#201040,#05020b 55%);
      color:var(--text);
    }
    header{
      padding:16px 18px 10px;
      color:#fff;
    }
    .topbar{
      max-width:1100px;
      margin:0 auto;
      padding:4px 4px 0;
    }
    .back{
      display:inline-flex;
      gap:8px;
      align-items:center;
      text-decoration:none;
      font-weight:bold;
      color:rgba(255,255,255,0.9);
      font-size:14px;
    }
    .back span{font-size:18px}
    .back:hover{opacity:.9}
    .logo{
      margin-top:6px;
      font-size:18px;
      font-weight:bold;
    }
    .logo span{opacity:.8;font-weight:normal;font-size:14px}

    .wrap{
      max-width:1100px;
      margin:10px auto 30px;
      padding:0 12px 24px;
    }

    .hero{
      position:relative;
      display:grid;
      grid-template-columns: minmax(0,320px) minmax(0,1fr);
      gap:0;
      border-radius:22px;
      overflow:hidden;
      background:
        radial-gradient(circle at top left,rgba(255,126,179,0.35),transparent 55%),
        radial-gradient(circle at bottom right,rgba(185,131,255,0.35),transparent 55%),
        #12071f;
      box-shadow:var(--shadow);
      min-height:340px;
    }
    .poster{
      position:relative;
      overflow:hidden;
    }
    .poster img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .poster::after{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(to right,rgba(0,0,0,0.4),transparent);
    }

    .hero-info{
      padding:18px 20px 18px 18px;
      position:relative;
      z-index:1;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
    }
    .hero-info h1{
      margin:0 0 6px;
      font-size:26px;
      letter-spacing:0.02em;
    }
    .nota{
      font-weight:bold;
      color:var(--accent);
      margin:4px 0 8px;
      font-size:15px;
    }
    .tags{
      margin:4px 0 10px;
    }
    .tag{
      display:inline-block;
      padding:4px 9px;
      border-radius:999px;
      background:rgba(0,0,0,0.35);
      border:1px solid rgba(255,255,255,0.15);
      font-size:11px;
      margin:0 6px 4px 0;
      text-transform:uppercase;
      letter-spacing:0.08em;
      color:var(--sub);
    }
    .desc-curta{
      font-size:14px;
      line-height:1.6;
      color:#e7dcff;
    }
    .acoes{
      margin-top:12px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .btn{
      border:none;
      border-radius:999px;
      padding:7px 14px;
      font-size:13px;
      font-weight:bold;
      display:inline-flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
      background:rgba(0,0,0,0.35);
      color:#fff;
      border:1px solid rgba(255,255,255,0.25);
    }
    .btn:hover{background:rgba(0,0,0,0.6);}
    .btn-primary{
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:#28021c;
      border:none;
    }
    .btn-primary:hover{filter:brightness(1.05);}
    #btnFav.fav-ativo{
      background:rgba(255,255,255,0.15);
      border-color:var(--accent);
      color:var(--accent);
    }

    .colunas{
      display:grid;
      grid-template-columns:minmax(0,2.2fr) minmax(0,1.2fr);
      gap:18px;
      margin-top:22px;
    }

    .bloco{
      background:rgba(9,3,18,0.95);
      border-radius:18px;
      padding:16px 16px 18px;
      box-shadow:0 10px 28px rgba(0,0,0,0.7);
      border:1px solid rgba(255,255,255,0.03);
    }
    .bloco h2{
      margin:0 0 10px;
      font-size:18px;
      color:var(--accent);
    }
    .bloco p{
      margin:0 0 8px;
      font-size:14px;
      line-height:1.8;
      color:#e3dcff;
    }

    .video-wrap{
      margin-top:8px;
      border-radius:16px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.1);
      aspect-ratio:16/9;
    }
    .video-wrap iframe{
      width:100%;
      height:100%;
      border:0;
    }

    .rec-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
      gap:10px;
      margin-top:4px;
    }
    .rec-card{
      display:block;
      text-decoration:none;
      color:#fff;
      border-radius:14px;
      overflow:hidden;
      background:#14071f;
      border:1px solid rgba(255,255,255,0.05);
      box-shadow:0 8px 22px rgba(0,0,0,0.75);
      transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    }
    .rec-card img{
      width:100%;
      height:180px;
      object-fit:cover;
      display:block;
    }
    .rec-title{
      padding:8px 9px 10px;
      font-size:13px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .rec-card:hover{
      transform:translateY(-3px);
      box-shadow:0 12px 30px rgba(0,0,0,0.9);
      border-color:var(--accent);
    }

    footer{
      text-align:center;
      color:#a99bd8;
      font-size:13px;
      padding:16px 10px 20px;
      border-top:1px solid rgba(255,255,255,0.05);
      background:#07020f;
    }
    footer a{color:var(--accent);text-decoration:none;}
    footer a:hover{text-decoration:underline;}

    @media(max-width:860px){
      .hero{
        grid-template-columns:1fr;
      }
      .hero-info{
        padding:14px 14px 16px;
      }
      .colunas{
        grid-template-columns:1fr;
      }
    }
  </style>
</head>
<body>

<header>
  <div class="topbar">
    <a class="back" href="../index.html"><span>‚Üê</span> Voltar para Planeta Dorama</a>
    <div class="logo">Planeta Dorama üåç <span>ficha do dorama</span></div>
  </div>
</header>

<div class="wrap">
  <section class="hero">
    <div class="poster">
      <img src="${imagem}" alt="P√¥ster do dorama ${d.nome}">
    </div>
    <div class="hero-info">
      <div>
        <h1>${nomeExibicao}</h1>
        <div class="nota">‚≠ê ${nota}</div>
        <div class="tags">
          ${tagsHtml}
        </div>
        <div class="desc-curta">${descCurta}</div>
      </div>
      <div class="acoes">
        <button class="btn btn-primary" onclick="window.location.href='../index.html'">üè† In√≠cio</button>
        <button class="btn" id="btnFav">ü§ç Favoritar</button>
        <button class="btn" id="btnShare">üì§ Compartilhar</button>
      </div>
    </div>
  </section>

  <section class="colunas">
    <div class="bloco">
      <h2>Resumo</h2>
      <p>${corpo}</p>
    </div>
    <div class="bloco">
      <h2>Onde assistir</h2>
      <p>Este dorama costuma estar dispon√≠vel em plataformas de streaming como a <b>Netflix</b>, mas o cat√°logo pode mudar com o tempo.</p>
      <p><b>Dica:</b> pesquise pelo nome <b>"${nomeExibicao}"</b> diretamente na sua plataforma favorita.</p>
    </div>
  </section>

  ${trailerBloco}
  ${recomendadosHtml}
</div>

<footer>
  <p>üíú Planeta Dorama üåç ‚Äî todos os direitos reservados</p>
  <p><a href="../politica.html">Pol√≠tica de Privacidade</a> ‚Ä¢ <a href="../termos.html">Termos de Uso</a></p>
</footer>

<script>
  const FAV_KEY = "pd_favoritos_v1";
  const nome = ${JSON.stringify(d.nome)};
  const pageUrl = "${urlPagina}";

  function getFav(){
    try { return JSON.parse(localStorage.getItem(FAV_KEY) || "[]"); }
    catch(e){ return []; }
  }
  function setFav(list){
    localStorage.setItem(FAV_KEY, JSON.stringify(list));
  }
  function isFav(){
    return getFav().includes(nome);
  }
  function updateFavBtn(){
    const btn = document.getElementById("btnFav");
    if(!btn) return;
    if(isFav()){
      btn.classList.add("fav-ativo");
      btn.innerHTML = "üíú Favorito";
    } else {
      btn.classList.remove("fav-ativo");
      btn.innerHTML = "ü§ç Favoritar";
    }
  }
  function toggleFav(){
    let list = getFav();
    if(isFav()){
      list = list.filter(n => n !== nome);
    } else {
      list.push(nome);
    }
    setFav(list);
    updateFavBtn();
  }

  const btnFav = document.getElementById("btnFav");
  if(btnFav) btnFav.addEventListener("click", toggleFav);

  const btnShare = document.getElementById("btnShare");
  if(btnShare){
    btnShare.addEventListener("click", async () => {
      const text = "Olha esse dorama que encontrei no Planeta Dorama: " + nome + " " + pageUrl;
      if(navigator.share){
        try{
          await navigator.share({ title:nome, text, url:pageUrl });
        }catch(e){}
      } else if(navigator.clipboard){
        try{
          await navigator.clipboard.writeText(pageUrl);
          alert("Link copiado! ‚úÖ");
        }catch(e){
          const wa = "https://wa.me/?text=" + encodeURIComponent(text);
          window.open(wa, "_blank");
        }
      } else {
        const wa = "https://wa.me/?text=" + encodeURIComponent(text);
        window.open(wa, "_blank");
      }
    });
  }

  updateFavBtn();
<\/script>

</body>
</html>`;
  }

  async async async function gerarPaginasPremium(){
    try{
      if(!Array.isArray(doramas) || !doramas.length){
        log("‚ùå N√£o encontrei lista de doramas no doramas.js");
        return;
      }

      log("‚úÖ Lendo " + doramas.length + " doramas...");
      const zip = new JSZip();
      const pasta = zip.folder("doramas");

      doramas.forEach(d => {
        if(!d || !d.nome) return;
        const slug = d.slug || criarSlug(d.nome, d.nomeEN);
        const html = montarHtmlPremium(d, doramas);
        const nomeArquivo = slug + ".html";
        pasta.file(nomeArquivo, html);
        log("‚úî Criada p√°gina: doramas/" + nomeArquivo);
      });

      log("\n‚è≥ Compactando tudo em ZIP...");
      const blob = await zip.generateAsync({type:"blob"});
      saveAs(blob, "paginas-doramas-premium.zip");
      log("üéâ Pronto! ZIP baixado. Extraia e envie os arquivos para a pasta /doramas no GitHub.");
    }catch(e){
      log("‚ùå Erro ao gerar: " + e.message);
      console.error(e);
    }
  }
</script>

</body>
</html>
