<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gerar p√°ginas de doramas | Planeta Dorama üåç</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body{
      font-family: Arial, sans-serif;
      background:#fff0f6;
      margin:0;
      padding:0;
      color:#333;
    }
    header{
      background:linear-gradient(90deg,#ff7eb3,#b983ff);
      color:#fff;
      text-align:center;
      padding:20px;
    }
    main{
      max-width:900px;
      margin:30px auto;
      background:#fff;
      padding:20px;
      border-radius:16px;
      box-shadow:0 6px 18px rgba(0,0,0,0.12);
    }
    button{
      padding:14px 20px;
      border:none;
      border-radius:12px;
      background:#ff7eb3;
      color:#fff;
      font-weight:bold;
      font-size:16px;
      cursor:pointer;
      margin-top:10px;
    }
    button:hover{
      background:#b983ff;
    }
    .log{
      margin-top:16px;
      padding:12px;
      background:#fff7fb;
      border-radius:10px;
      max-height:260px;
      overflow:auto;
      font-size:14px;
      white-space:pre-wrap;
    }
    code{
      background:#eee;
      padding:2px 4px;
      border-radius:4px;
      font-size:13px;
    }
  </style>

  <!-- JSZip e FileSaver para gerar o .zip -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <!-- Seu arquivo de dados -->
  <script src="doramas.js"></script>
</head>
<body>

<header>
  <h1>Gerador de p√°ginas est√°ticas üåç</h1>
  <p>Planeta Dorama ‚Äì gerar <b>/doramas/slug.html</b> para todos os doramas</p>
</header>

<main>
  <h2>Como usar</h2>
  <ol>
    <li>Confirme que <code>doramas.js</code> est√° atualizado com todos os doramas.</li>
    <li>Abra esta p√°gina pelo endere√ßo do GitHub Pages:
      <br>ex.: <code>https://planetadorama.com.br/gerar-paginas.html</code>
    </li>
    <li>Clique no bot√£o abaixo para gerar um arquivo <b>.zip</b> com todas as p√°ginas.</li>
    <li>Extraia o ZIP no seu computador.</li>
    <li>No GitHub, entre na pasta <code>doramas</code> (crie se n√£o existir) e envie todos os
        arquivos <code>.html</code> gerados (pode sobrescrever os antigos).</li>
  </ol>

  <button onclick="gerarPaginas()">üöÄ Gerar ZIP com todas as p√°ginas</button>

  <div class="log" id="log"></div>
</main>

<script>
  function log(msg){
    const box = document.getElementById("log");
    box.textContent += msg + "\n";
    box.scrollTop = box.scrollHeight;
  }

  function textoDescricao(d){
    const txt = (d.resumo || d.descricao || "").trim();
    if(!txt) return "";
    return txt.replace(/\n/g,"<br>");
  }

  function primeiraFrase(d){
    const txt = (d.descricao || d.resumo || "").trim();
    if(!txt) return "";
    return txt.split("\n")[0];
  }

  function montarHtml(d){
    const titulo = d.nome + " | Planeta Dorama üåç";
    const descCurta = primeiraFrase(d) || "Saiba mais sobre o dorama " + d.nome + ".";
    const corpo = textoDescricao(d);
    const nota = d.nota || "";
    const ano = d.ano ? `<span class="chip">${d.ano}</span>` : "";
    const pais = d.pais ? `<span class="chip">${d.pais}</span>` : "";
    const eps = d.episodios ? `<span class="chip">${d.episodios} eps</span>` : "";
    const trailer = d.trailer ? `
      <section class="bloco">
        <h2>üé¨ Trailer</h2>
        <div class="video-wrap">
          <iframe src="${d.trailer}" allowfullscreen loading="lazy"></iframe>
        </div>
      </section>
    ` : "";

    return `<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${titulo}</title>
  <meta name="description" content="${descCurta.replace(/"/g,'&quot;')}">

  <meta property="og:site_name" content="Planeta Dorama üåç">
  <meta property="og:type" content="article">
  <meta property="og:title" content="${d.nome} | Planeta Dorama üåç">
  <meta property="og:description" content="${descCurta.replace(/"/g,'&quot;')}">
  <meta property="og:url" content="https://planetadorama.com.br/doramas/${d.slug}.html">
  <meta property="og:image" content="${d.imagem || "https://planetadorama.com.br/imagens/og-capa.jpg"}">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="${d.nome} | Planeta Dorama üåç">
  <meta name="twitter:description" content="${descCurta.replace(/"/g,'&quot;')}">
  <meta name="twitter:image" content="${d.imagem || "https://planetadorama.com.br/imagens/og-capa.jpg"}">

  <style>
    :root{
      --rosa:#ff7eb3;
      --roxo:#b983ff;
      --texto:#333;
    }
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background:#fff0f6;
      color:var(--texto);
    }
    header{
      background:linear-gradient(90deg,var(--rosa),var(--roxo));
      color:#fff;
      text-align:center;
      padding:20px;
    }
    header a{
      color:#fff;
      text-decoration:none;
      font-weight:bold;
      display:inline-block;
      margin-top:8px;
    }
    .container{
      max-width:1100px;
      margin:20px auto 40px;
      padding:0 16px;
    }
    .hero{
      background:#fff;
      border-radius:20px;
      box-shadow:0 10px 25px rgba(0,0,0,0.12);
      overflow:hidden;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:20px;
    }
    .poster img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .poster{
      height:100%;
      max-height:460px;
      overflow:hidden;
    }
    .hero-text{
      padding:18px 18px 18px 0;
    }
    .hero-text h1{
      margin:0 0 10px;
      font-size:28px;
      color:#b4005a;
    }
    .chips{
      margin-bottom:10px;
    }
    .chip{
      display:inline-block;
      background:#ffe6f4;
      color:#b4005a;
      padding:6px 10px;
      border-radius:999px;
      font-size:13px;
      margin:4px 6px 0 0;
      font-weight:bold;
    }
    .nota{
      margin-top:8px;
      font-size:15px;
      color:#7a1b55;
      font-weight:bold;
    }
    .bloco{
      margin-top:24px;
      background:#fff;
      padding:18px;
      border-radius:18px;
      box-shadow:0 6px 16px rgba(0,0,0,0.08);
    }
    .bloco h2{
      margin:0 0 10px;
      color:#b4005a;
      font-size:20px;
    }
    .bloco p{
      margin:0;
      line-height:1.7;
      font-size:16px;
    }
    .video-wrap{
      margin-top:10px;
      aspect-ratio:16/9;
      border-radius:16px;
      overflow:hidden;
      border:2px solid rgba(255,126,179,0.6);
    }
    .video-wrap iframe{
      width:100%;
      height:100%;
      border:0;
    }
    footer{
      text-align:center;
      padding:15px;
      background:#b983ff;
      color:#fff;
      font-size:14px;
    }
    footer a{ color:#fff; text-decoration:underline; }
    @media(max-width:800px){
      .hero{
        grid-template-columns:1fr;
      }
      .hero-text{
        padding:16px;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>üåç Planeta Dorama</h1>
  <a href="../index.html">‚¨Ö Voltar para a p√°gina inicial</a>
</header>

<div class="container">
  <section class="hero">
    <div class="poster">
      <img src="${d.imagem}" alt="${d.nome}">
    </div>
    <div class="hero-text">
      <h1>${d.nome}</h1>
      <div class="chips">
        ${ano}
        ${pais}
        ${eps}
      </div>
      <div class="nota">‚≠ê ${nota}</div>
      <div class="bloco" style="margin-top:16px;">
        <h2>Sobre o dorama</h2>
        <p>${corpo}</p>
      </div>
    </div>
  </section>

  ${trailer}
</div>

<footer>
  <p>üíú Planeta Dorama üåç ‚Äî feito com amor</p>
  <p><a href="../index.html">Voltar para o in√≠cio</a></p>
</footer>

</body>
</html>`;
  }

  async function gerarPaginas(){
    if(!Array.isArray(doramas) || doramas.length === 0){
      log("‚ùå N√£o consegui ler a lista de doramas. Confirme se doramas.js est√° correto.");
      return;
    }

    log("‚úÖ Lendo " + doramas.length + " doramas do arquivo doramas.js...");
    const zip = new JSZip();
    const pasta = zip.folder("doramas");

    doramas.forEach(d => {
      const slug = d.slug || (d.nome || "").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");
      if(!slug){
        log("‚ö† Ignorando dorama sem nome v√°lido.");
        return;
      }
      const html = montarHtml(Object.assign({}, d, { slug }));
      const nomeArquivo = slug + ".html";
      pasta.file(nomeArquivo, html);
      log("‚úî P√°gina criada: doramas/" + nomeArquivo);
    });

    log("\n‚è≥ Compactando tudo em um arquivo ZIP...");
    const blob = await zip.generateAsync({type:"blob"});
    saveAs(blob, "paginas-doramas-planetadorama.zip");
    log("üéâ Pronto! ZIP baixado. Agora √© s√≥ extrair e enviar os arquivos para a pasta /doramas no GitHub.");
  }
</script>

</body>
</html>
